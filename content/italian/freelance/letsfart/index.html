<!DOCTYPE html>
<html lang="en">

<head>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>It's Fart Time</title>
    <meta name="author" content="Alby Rei Web Designer & Developer">
    <link rel="icon" href="./assets/images/fartsmoke.png" type="image/png" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Pangolin">
    <link rel="stylesheet"
        href="https://use.fontawesome.com/releases/v5.12.1/css/all.css?ver=01e35d78885ea60c37440866fef14c15">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="./assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="./style.css">

    <!-- Find fart -->
    <script type="text/javascript">
        function findfart() {
            if (typeof (Storage) !== "undefined") {
                // Store
                //localStorage.setItem("fartname", "Fart_Squeeze1.mp3");
                // Retrieve
                varfart = localStorage.getItem("fartname");
            } else {
                varfart = 0;
            }
            return varfart;
        }
        //if fartsound = TRUE then play fart-
        function controlfartsound() {
            fartsound = localStorage.getItem("fartsound");
            if (fartsound == "TRUE") {
                playAudio();
            }
        }
    </script>

</head>

<body onload="controlfartsound()">
    <main id="swup" class="transition-fade">

        <div class="container">
            <div class="row text-center mt-5 mb-5">
                <div class="col-lg-5 mx-auto">
                    <!-- Header -->
                    <header>
                        <h1>
                            Click the button!
                        </h1>
                    </header>
                </div>
            </div>
            <div class="row text-center">
                <div class="col-lg-5 mx-auto">
                    <!-- Principal button-->
                    <div class="btn fartbutton w-100" onclick="playAudio()" style="cursor:pointer">
                        <div class="wrap">
                            <img src="./assets/images/fartsmoke.png" alt="Let's Fart!">FART
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-5 mx-auto">
                    <!-- Menu -->
                    <div class="menu">
                        <a href="timer.html" class="linkbutton" title="Let's Fart - Set a Timer">
                            <div class="menubutton">
                                <div class="wrapmenu yellow">
                                    <img src="./assets/images/timer.png" title="Let's Fart - Set a Timer"
                                        alt="Let's Fart - Set a Timer"> Set a timer
                                </div>
                            </div>
                        </a>
                    </div>
                    <div class="menu">
                        <a href="sounds.html" class="linkbutton" title="Let's Fart - Select a sound">
                            <div class="menubutton">
                                <div class="wrapmenu yellow">
                                    <img src="./assets/images/sound.png" title="Let's Fart - Select a sound"
                                        alt="Let's Fart - Select a sound"> Select a sound
                                </div>
                            </div>
                        </a>
                    </div>

                    <!-- <div class="menu">
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://letsfart.altervista.org&t=Lets Fart"
                            onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=300,width=600');return false;"
                            target="_blank" title="Share on Facebook">
                            <i class="fab fa-facebook-square"></i>
                        </a>
                        <a href="https://twitter.com/share?url=https://letsfart.altervista.org&via=letsfart.albertoreineri.it&text=Let's Fart"
                            title="Let's Fart Share Button"
                            onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"
                            target="_blank" title="Share on Twitter">
                            <i class="fab fa-twitter-square"></i>
                        </a>
                        <a href="whatsapp://send?text=https://letsfart.altervista.org" title="Let's Fart Share Button"
                            data-action="share/whatsapp/share">
                            <i class="fab fa-whatsapp-square"></i>
                        </a>
                        <a href="mailto:?subject=Let's Fart&amp;body=https://letsfart.altervista.org" target="_blank"
                            title="Share by Email" title="Let's Fart Share Button">
                            <i class="fas fa-envelope-square"></i>
                        </a>
                    </div> -->
                </div>
            </div>

        </div>
        <!-- Play script -->
        <script>
            var x = document.getElementById("myAudio");
            //setted sound
            function playAudio() {

                if (typeof (Storage) !== "undefined") {
                    // Store
                    //localStorage.setItem("fartname", "Fart_Squeeze.mp3");
                    // Retrieve

                    varfart = localStorage.getItem("fartname");
                    if (!varfart) {
                        varfart = "Fart_Squeeze.mp3";
                        localStorage.setItem("fartsound", "FALSE");
                    }
                }

                var x = new String("assets/sound/" + varfart + "");
                //Play sound
                var audio = new Audio(x);
                audio.play();

            }
        </script>
        <div class="credits mb-5">
            By <a href="https://albertoreineri.github.io" target="_blank"
                title="Alby Rei Web Designer & Developer">Alby Rei</a>
        </div>
        </div>
        <!-- Bootstrap JS -->
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
            integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous">
            </script>
        <script src="./assets/js/bootstrap.min.js"></script>

        <script language="javascript" type="text/javascript">

            $.ajax({
                url: "assets/sound/",
                success: function (data) {
                    $(data).find("a:contains(.mp3)").each(function () {
                        // will loop through
                        var sounds = $(this).attr("href");
                        var mp3 = $(this).attr("href");
                        sounds = sounds.replace('/assets/sound/', '');
                        sounds = sounds.replace('-www.fesliyanstudios.com.mp3', '');

                        var soundItem = `<div class="col-12 text-center" id = "soundName" style = "font-size:30px" > ` + sounds + `</div > \
                                    <div class="col-12 mb-3 text-center" style="font-size:24px"> \
                                        <audio controls onplay="setSound('`+ mp3 + `')"> \
                                            <source src="`+ mp3 + `" type="audio/mpeg"> \
                                                Your browser does not support the audio element. \
                                        </audio> \
                                    </div>`;

                        $('#soundsList').append(soundItem);
                        // $('<p></p>').html(soundItem).appendTo('#soundsList')

                    });
                }
            });

            // $.ajax({
            //     url: "assets/sound/",
            //     success: function (data) {
            //         var soundItems = []
            //         // $(data).find("td > a").each(function () {
            //         //     // will loop through
            //         //     var sound = $(this).attr("href");
            //         //     alert(sound);
            //         //     // var soundItem = '<div class="col-12 text-center" id = "soundName" style = "font-size:30px" > ' + sound + '</div > \
            //         //     //         <div class="col-12 mb-3 text-center" style="font-size:24px"> \
            //         //     //             <audio controls onplay="setSound('+ sound + ')"> \
            //         //     //                 <source src="/assets/sound/<?php echo $file ?>" type="audio/mpeg"> \
            //         //     //                     Your browser does not support the audio element. \
            //         //     //             </audio> \
            //         //     //         </div>';
            //         //     // soundItems.push(soundItem);
            //         // });
            //     }
            // }).done(function () {
            //     console.log(this.soundItems);
            // });;

            function setSound(sound) {
                localStorage.setItem("fartname", sound);
            }

            function controlminute(varminute) {
                if (varminute > 59) {
                    document.getElementById("error").style.visibility = "visible";
                    document.getElementById("minute").value = "";
                    document.getElementById("minute").focus();
                } else {
                    document.getElementById("error").style.visibility = "hidden";
                }
            }

            function controlsecond(varsecond) {
                if (varsecond > 59) {
                    document.getElementById("error").style.visibility = "visible";
                    document.getElementById("second").value = "";
                    document.getElementById("second").focus();
                } else {
                    document.getElementById("error").style.visibility = "hidden";
                }
            }


            function starttimer() {
                minute = (60 * document.getElementById("minute").value);
                minute = (minute + +document.getElementById("second").value)
                duration = minute;
                display = document.querySelector('#time');
                document.getElementById("timeleft").style.visibility = "visible";
                var timer = duration,
                    minutes, seconds;

                setInterval(function () {

                    minutes = parseInt(timer / 60, 10)
                    seconds = parseInt(timer % 60, 10);

                    minutes = minutes < 10 ? "0" + minutes : minutes;
                    seconds = seconds < 10 ? "0" + seconds : seconds;

                    display.textContent = minutes + ":" + seconds;

                    if (--timer < 0) {
                        localStorage.setItem("fartsound", "TRUE");
                        window.location.href = "/letsfart";

                        document.getElementById("minute").value = 0;
                        document.getElementById("second").value = 0;
                    }
                }, 1000);
            }

        </script>

</body>

</html>